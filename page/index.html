<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/compress.js@1.0.1"></script>
    <link rel="icon" href="../mo.png" type="image/x-icon">

    <title>main page</title>
    <style>
        * {
            /* margin: 0px; */
            /* color: #00ff4c; */
        }

        body {

            margin: 0%;
            /* position: relative; */
            /* background-color: transparent;  */
            /* z-index: 7; */
            /* overflow: hidden; */
        }

        .bubbled-rectangle {
            width: 60px;
            height: 20px;
            background-color: #3498db;
            border-radius: 50px;
            position: relative;
            top: 20px;
        }

        .bubbled-rectangle:hover {
            background-color: #0091ff;
            cursor: pointer;
        }

        #btn {
            border-radius: 50%;
            background-color: #0a4f7e;
            width: 30px;
            height: 30px;
            position: relative;
            bottom: 5px;
            transition: 300ms;
        }

        .trn {
            translate: 30px 0px;
        }

        .trn2 {
            translate: 30px 0px;
            transition: none;
        }

        .paner {
            background-color: white;
        }

        .main {
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
            height: 100%;
            width: 100%;
            margin: 0px;
            background-color: rgb(255, 255, 255);
            /* الوضع النهاري */
            /* overflow: hidden; */
        }

        .main.mod {
            background-color: rgb(5, 43, 67);
            /* الوضع الليلي */
        }

        .sidbar {
            width: 0px;
            height: 100%;
            position: fixed;
            top: 55px;
            left: 0%;
            background-color: #08324d;
            transition: 200ms;
            z-index: 5;
            overflow: hidden;
            border-radius: 10px;
        }

        .sidbar div {
            display: flex;
            justify-content: space-between;
        }

        .open {
            width: 250px;
            transition: 200ms;
        }

        .box-sh {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0;
            transition: opacity 900ms;

        }

        .iso {
            z-index: 2;
            background-color: rgba(0, 0, 0, 0.357);
            opacity: .3;
        }

        .pnr {
            width: 100%;
            height: 5px;
            position: relative;
            z-index: 1;
        }

        .sid {
            /* padding: 6px 7px 6px 7px; */
            position: relative;
            left: 5px;
            z-index: 3;
        }

        .sid:hover {
            cursor: pointer;
            scale: 1.1;
            transition: 300ms;
        }



        .light {
            background-color: #ffffff;
        }

        .dark {
            background-color: #08324d;
        }

        .sid-dark {
            width: 250px;
            height: 40px;
            color: #08324d;
            background-color: #ffffff;
            border: none;
            border-radius: 10px;
        }

        .sid-light {
            width: 250px;
            height: 40px;
            border-radius: 10px;
            /* border: solid 1px; */
            background-color: #08324d;
            color: #ffffff;
            border: none;
        }

        .xo {
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 0px 30px 0px 30px;
        }

        .xo:hover {
            border-radius: 20px;
            scale: 1.1;
            cursor: pointer;
            transition: 200ms;
            background-color: #005ca2;
            color: aliceblue;
        }


        #tl {
            padding: 10px;
            border-radius: 10px;
            /* margin-top: 0%; */
            font-family: Arial, Helvetica, sans-serif;
            font-weight: 700;
        }

        #log-o {
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgb(161, 0, 0);
            color: #ffffff;
            border-radius: 10px;
            height: 50px;
            position: absolute;
            bottom: 60px;
            left: 10px;
            width: 90%;
            cursor: pointer;
            transition: 300ms;
        }

        #log-o:hover {
            scale: 1.1;
            background-color: rgb(196, 29, 29);
        }

        textarea {
            width: 100%;
            height: fit-content;
            padding: 5px;
            border: none;
            overflow: hidden;
            resize: none;
            box-sizing: border-box;
            outline: none;
            background-color: #f0f5fd00;
            color: inherit;
            margin: 0%;
        }

        .wel {
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            height: 0px;
            transition: height 300ms;
        }

        .nshr {
            position: relative;
            z-index: 1;
            left: 20%;
            margin-top: 3px;
            margin-right: 5px;
            border: none;
            padding: 5px 10px 5px 10px;
            cursor: pointer;
            background-image: linear-gradient(rgb(0, 111, 128), rgb(0, 70, 92), rgb(0, 149, 255));
            scale: 1.1;
            border-radius: 8px;
            color: #ffffff;
            transition: 500ms;

        }

        .nshr:hover {
            scale: 1.2;
            background-image: linear-gradient(rgb(7, 132, 151), rgb(0, 88, 115), rgb(76, 169, 235));
        }

        .head-img {
            position: relative;
            z-index: 1;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        .post {
            border: solid 1px;
            border-radius: 10px;
            width: 500px;
            /* max-height: 600px; */
            overflow: hidden;
            margin-bottom: 10px;
            /* text-align: center; */
            padding: 10px;
        }

        .three-dot {
            border: none;
            background-color: rgba(240, 248, 255, 0);
            color: inherit;
            border-radius: 10px;
            scale: 1.2;
            cursor: pointer;
            margin: 5px 0px 0px 7px;
            /* height: 20px; */
            height: 20px;
        }

        .three-dot:hover {
            scale: 1.3;
            background-color: rgb(0, 85, 134);
            color: #ffffff;
        }

        .paner-post {
            width: 100%;
            height: px;
            display: flex;
            justify-content: space-between;
        }

        .paner_post_img_div {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            border: solid 1px;
            /* cursor: pointer; */
            opacity: .99;
        }

        .paner_post_img_div:hover {
            cursor: pointer;
            opacity: .7;
        }

        .div_after_dot {
            width: 300px;
            height: 100px;
            background-color: #0091ff00;
            overflow: hidden;
            position: absolute;
            /* z-index: 2; */
            translate: 0px 20px;
            direction: rtl;
            /* لضبط الاتجاه من اليمين إلى اليسار */
            text-align: right;
            /* display: none; */
            opacity: .99;
        }

        .div_after_dot_iner {
            transition: 200ms;
            translate: 0px -50px;
            background-color: #09456d;
            /* border: solid 1px; */
            width: 90px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            scale: 1.3;
            color: #ffffff;
            border-radius: 5px;
            cursor: pointer;
            position: relative;
            z-index: 2;
            box-shadow: 5px 5px 8px 0px rgb(0, 0, 0);

        }

        .div_after_dot_iner:hover {
            scale: 1.4;
            background-color: #0060aa;
        }

        .paner_post_img_name {
            margin-top: 10px;
            /* margin-left: 20px; */
            display: flex;
            justify-content: flex-start;
            width: 320px;
            /* direction: rtl; */
            cursor: pointer;
            opacity: .99;
        }

        .bottom_post {
            opacity: .99;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: solid 1px;
            height: 40px;
            width: 100%;
            scale: 1.1 1;
            margin-bottom: -5px;
        }

        .div_like {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 50%;
            height: 100%;
            background-image: linear-gradient(rgb(87, 138, 146), rgb(0, 70, 92), rgb(0, 149, 255));
            font-size: x-large;
            color: white;
            cursor: pointer;
        }

        .div_comment {
            display: flex;
            background-image: linear-gradient(rgb(87, 138, 146), rgb(0, 70, 92), rgb(0, 149, 255));
            color: white;
            width: 50%;
            height: 100%;
            justify-content: center;
            align-items: center;
            border-left: solid 1px;
            font-size: x-large;
            cursor: pointer;
        }

        .div_comment:hover,
        .div_like:hover {

            background-image: linear-gradient(rgb(7, 132, 151), rgb(0, 88, 115), rgb(76, 169, 235));
            transition: 200ms;
        }

        .width_300 {
            width: 300px;
        }

        .hight_500 {
            height: 500px;
        }

        .hight_300 {

            height: 300px;
        }

        @media (min-width: 700px) {

            .not {
                width: 250px;
                margin-left: 80px;
            }

            .div_after_dot {
                width: 400px;
            }

            .post {
                padding: 5px;
                border: solid 1px;
                border-radius: 10px;
                width: 500px;
                /* max-height: 500px; */
                /* overflow: hidden; */
                margin-bottom: 10px;
                width: 400px;
                height: 62%;
            }
        }

        @media (max-width: 700px) {

            .width_300 {
                width: 300px;
            }

            .hight_500 {
                height: 500px;
            }

            .hight_300 {

                height: 180px;
            }

            .paner_post_img_name {
                margin-top: 10px;
                /* margin-left: 20px; */
                display: flex;
                justify-content: flex-start;
                width: 220px;
                /* direction: rtl; */
                cursor: pointer;
                opacity: .99;
            }

            .sid {
                width: 100px;
            }

            .post {
                width: 300px;
                ;
                margin-bottom: 10px;
                padding: 5px;


            }

            .not {
                width: 50px;
            }
        }

        @media (max-width: 390px) {
            .sid {
                width: 50px;
            }

            .post {
                width: 300px;

            }
        }

        .profile_img {
            cursor: pointer;
            overflow: hidden;
            margin-bottom: 5px;
            width: 50px;
            height:
                50px;
            border-radius: 50%;
            display: flex;
            border: solid 1px;
            justify-content: center;
            align-items: center;
            background-color: #b7b7b700;

        }

        .profile_img:hover {
            transition: 200ms;
            opacity: .7;
        }

        .like_result {
            /* color: rgb(144, 132, 23); */
        }

        .cont_not {
            position: fixed;
            top: 50px;
            overflow: hidden;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 2;
        }

        .not {
            /* border: solid 1px; */
            border-radius: 10px;
            width: 180px;
            /* min-height: 50px; */
            padding: 0px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #00355d;
            color: #ffffff;
            height: 0px;
            transition: 300ms;


        }

        .no_hight {
            height: 0px;
            /* min-height: 0px; */
            padding: 0px;

        }

        .hight_50 {
            height: 60px;
            padding: 0px;
        }

        .comment_result {
            /* padding: 20px; */
            gap: 20px;
            /* display: flex; */
            flex-direction: column;
            align-items: center;
            /* justify-content: center; */
            /* text-align: center; */
            width: 100%;
            height: 100%;
            display: none;
            /* justify-content: center; */
            position: fixed;
            top: 50px;
            z-index: 1;
            background-color: #000000cf;
            overflow: scroll;
            /* align-content: center; */
        }

        .img_comment {
            margin: 20px 0px 20px 0px;
        }

        .inp_comment {
            position: fixed;
            bottom: 10px;
            left: 16%;

            width: 60%;
            height: 30px;
            padding: 5px 10px 5px 10px;
            border-radius: 20px;
            font-size: large;
            outline: none;
            border: solid 1px;
        }

        .inp_btn_comment {
            position: fixed;
            bottom: 15px;
            left: 81%;
            height: 30px;
            width: 30px;
            cursor: pointer;
            border-radius: 50%;
            border: none;
            background-image: linear-gradient(rgb(7, 132, 151), rgb(0, 88, 115), rgb(76, 169, 235));
            scale: 1.2;
            color: rgb(255, 255, 255);
        }

        .inp_btn_comment:active {
            background-image: linear-gradient(rgb(7, 132, 151), rgb(0, 155, 194), rgb(0, 220, 240));

            scale: 1.1;
        }

        .x {
            scale: 3;
            position: fixed;
            border: none;
            color: rgba(255, 255, 255, 0.699);
            background-color: #00355d00;
            font-weight: -10px;
            top: 90px;
            right: 40px;

        }

        .x:hover {
            color: white;
            cursor: pointer;
        }

        .scroll_up {
            position: fixed;
            bottom: 20px;
            right: 30px;
            border-radius: 50%;
            border: none;
            background-image: linear-gradient(rgb(0, 111, 128), rgb(0, 70, 92), rgb(0, 149, 255));
            color: white;
            width: 20px;
            height: 25px;
            scale: 1.5;
            padding: 5px;
            cursor: pointer;
            display: none;
        }

        .scroll_up:hover {
            background-image: linear-gradient(rgb(0, 149, 255), rgb(0, 149, 255), rgb(0, 149, 255));

        }
    </style>

<body class="main">

    <div class="box-sh"></div>
    <div class="paner"
        style="display: flex;align-items: center; justify-content: space-between; ; height: 50px;position: sticky;top: 0; z-index: 3;">
        <button class="sid"><i class="fas fa-cog"></i></button>
        <button class="sid bell"> <i class='fas fa-bell'></i></button>

        <h1 id="tl">moo book</h1>

    </div>

    <br>
    <div class="wel">
        <h2><span class="user1"></span>احسنت يا </h2>
    </div>
    <div class="head-img">
        <div class="profile_img" style="">
            <!-- <i class='fas fa-user-alt'></i> -->
            <img class="img1" width="50px" alt="">
        </div> <!-- -->
    </div>
    <div style="display: flex; justify-content: center;">
        <div class="div-post"
            style="position: relative;z-index: 1;width: fit-content; border: solid 1px ;border-radius: 10px;width: 60%;padding: 10px;">
            <textarea id="auto-resize-textarea" rows="1" placeholder="بم تفكر" style="margin-bottom: 0%;"></textarea>

            <div class="img-post" id="img-post" style="margin-top: 0%;">
                <!-- سيتم إضافة الصورة هنا -->
            </div>
        </div>

    </div>
    <div>
        <button class="nshr">نشر</button>
        <button class="nshr" id="upload-image-button">اضافة صورة <i class='fas fa-image'></i></button>
        <input type="file" id="image-input" style="display: none;">
        <button class="nshr cancel" style="display:none;">الغاء <i class='fas fa-times'></i></button>
    </div>
    <br><br>
    <div class="contpost" style="display: flex; flex-direction: column;align-items: center;">

        <!-- المنشورات المحفوظة -->
    </div>

    <div class="sidbar">
        <div>
            <h2 style="padding: 0px 8px 0px 8px;">white</h2>
            <div class="bubbled-rectangle">
                <div id="btn"></div>
            </div>
            <h2 style="padding: 0px 8px 0px 8px;">night</h2>
        </div>
        <div onclick="window.location.href='../xo/index.html'" class="xo"
            style="display: flex;align-items: center; justify-content: center; gap: 10px;">
            <h2>x&o</h2>
            <h2><i class='fas fa-gamepad' style="font-size: x-large;"> game </i></h2>
        </div>
        <div class="xo pp" style="display: flex;align-items: center; justify-content: center;">
<h2>
    profile

</h2>
        </div>
        <div id="log-o">
            <h2>log out <i class='fas fa-sign-out-alt'></i> </h2>

        </div>
    </div>
    <div class="cont_not">
        <div class="not">
            <p>.لا توجد اشعارات حتى الان</p>
        </div>
    </div>
    <button class="scroll_up"><i class='fas fa-arrow-up '></i></button>

    <script>
let main = document.querySelector('.main');
let btn = document.getElementById('btn');
let cont = document.querySelector('.bubbled-rectangle');
let sid = document.querySelectorAll('.sid');
let sidbar = document.querySelector('.sidbar');
let box = document.querySelector('.box-sh');
let tl = document.getElementById('tl');
let wel = document.querySelector('.wel');
const textarea = document.getElementById('auto-resize-textarea');
let log = document.getElementById('log-o');
let paner = document.querySelector('.paner');
let uploadImageButton = document.getElementById('upload-image-button');
let imageInput = document.getElementById('image-input');
let imgPost = document.getElementById('img-post');
let nshr = document.querySelector('.nshr');
let contpost = document.querySelector('.contpost');
let cancel = document.querySelector('.cancel');
let bell = document.querySelector('.bell');
let not = document.querySelector('.not');



bell.onclick = function (event) {
    not.classList.toggle('hight_50');
    event.stopPropagation();

}
cancel.onclick = function () {
    textarea.value = '';
    cancel.style.display = 'none';
    imgPost.innerHTML = '';
}
log.onclick = function () {
    location.replace('../index.html');
}

textarea.addEventListener('input', () => {
    autoResize();
    if (textarea.value === '') {
        cancel.style.display = 'none';
    } else {
        cancel.style.display = 'inline';
    }
});

function autoResize() {
    textarea.style.height = 'fit-content';
    textarea.style.height = textarea.scrollHeight + 'px';
}

uploadImageButton.addEventListener('click', () => {
    imageInput.click();
});

imageInput.addEventListener('change', (event) => {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
            const img = new Image();
            img.src = e.target.result;

            img.onload = function () {
                // Create a canvas element
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                // Set canvas dimensions to match image dimensions
                canvas.width = img.width;
                canvas.height = img.height;

                // Draw the image on the canvas
                ctx.drawImage(img, 0, 0);

                // Compress the image to reduce size (you can adjust the quality parameter)
                const compressedImage = canvas.toDataURL('image/jpeg', 0.5); // Quality between 0 and 1

                // Store compressed image in Local Storage
                localStorage.setItem('compressedImage', compressedImage);

                // Create and display the image element
                const imgElement = document.createElement('img');
                imgElement.src = compressedImage;
                imgElement.style.width = '100%';
                imgElement.style.maxHeight = '100%';
                imgElement.style.borderRadius = '10px';
                imgPost.innerHTML = '';
                imgPost.appendChild(imgElement);
                cancel.style.display = 'inline';
            };
        };
        reader.readAsDataURL(file);
    }
});

let likes = JSON.parse(localStorage.getItem('likes')) || {};

nshr.onclick = function () {
    cancel.style.display = 'none';
    let post = document.createElement('div');
    post.classList.add('post');

    let text = textarea.value.trim(); // إزالة المسافات الفارغة من النص
    let imgSrc = imgPost.querySelector('img') ? imgPost.querySelector('img').src : '';

    // شرط للتحقق من أن textarea تحتوي على حرف واحد على الأقل أو imgSrc ليس فارغاً
    if (text.length === 0 && !imgSrc) {
        alert("يرجى إدخال نص أو اختيار صورة قبل النشر.");
        return; // إنهاء الوظيفة إذا لم يتحقق أي من الشرطين
    }

    let postContent = document.createElement('div');
    postContent.innerHTML = `<p>${text}</p>`;
    postContent.style.margin = '0px';
    postContent.style.height = 'auto';

    if (imgSrc) {
        let img = document.createElement('img');
        img.src = imgSrc;
        img.style.width = '100%';
        img.style.maxHeight = '600px';
        img.style.borderRadius = '10px';
        img.style.margin = '0px';
        postContent.appendChild(img);
    }

    let paner_post = document.createElement('div');
    paner_post.classList.add('paner-post');
    let paner_post_img_div = document.createElement('div');
    paner_post_img_div.classList.add('paner_post_img_div');
    let paner_post_img = document.createElement('img');
    paner_post_img.style.width = '40px';
    paner_post_img.style.height = '45px';
    paner_post_img.src = "mu f.jpg";
    paner_post_img_div.appendChild(paner_post_img);
    paner_post.appendChild(paner_post_img_div);

    let paner_post_img_name = document.createElement('p');
    paner_post_img_name.classList.add('paner_post_img_name');
    paner_post_img_name.textContent = 'mohaned nabel';

    paner_post.appendChild(paner_post_img_name);

    let three_dot = document.createElement('button');
    three_dot.classList.add('fas', 'fa-ellipsis-h', 'three-dot');
    paner_post.appendChild(three_dot);

    let div_after_dot = document.createElement('div');
    div_after_dot.classList.add('div_after_dot');
    let div_after_dot_iner = document.createElement('div');
    div_after_dot_iner.textContent = 'حذف المنشور';
    div_after_dot_iner.classList.add('div_after_dot_iner');
    div_after_dot.appendChild(div_after_dot_iner);

    let bottom_post = document.createElement('div');
    bottom_post.classList.add('bottom_post');
    let div_like = document.createElement('div');
    div_like.textContent = 'اعجبني';
    div_like.classList.add('div_like');
    let div_comment = document.createElement('div');
    div_comment.textContent = 'تعليق';
    div_comment.classList.add('div_comment');
    bottom_post.appendChild(div_like);
    bottom_post.appendChild(div_comment);

    let like_result = document.createElement('p');
    like_result.textContent = 'لقد قمت بالتفاعل برمز الاعجاب على هذا المنشور';
    like_result.style.display = 'none'; // اخفائه في البداية
    like_result.classList.add('like_result');


    post.appendChild(div_after_dot);
    post.appendChild(paner_post);
    post.appendChild(postContent);
    post.appendChild(like_result);
    post.appendChild(bottom_post);
    contpost.appendChild(post);

    // إضافة المنشور في أعلى القائمة
    if (contpost.firstChild) {
        contpost.insertBefore(post, contpost.firstChild);
    } else {
        contpost.appendChild(post);
    }

    // حفظ المنشور في localStorage
    let savedPosts = JSON.parse(localStorage.getItem('posts')) || [];
    let postId = Date.now(); // استخدام timestamp كمعرف فريد
    savedPosts.unshift({ id: postId, text, imgSrc });
    localStorage.setItem('posts', JSON.stringify(savedPosts));

    // Clear the textarea and image
    textarea.value = '';
    imgPost.innerHTML = '';

    // Add event listeners for dynamic content
    document.addEventListener('click', function (event) {
        if (!div_after_dot_iner.contains(event.target)) {
            div_after_dot_iner.style.transform = 'translate(0px, -50px)';
            div_after_dot.style.transform = 'translate(0px, 0px)';
        }
    });

    three_dot.addEventListener('click', function (event) {
        div_after_dot_iner.style.transform = 'translate(-10px, 50px)';
        div_after_dot.style.display = "block";
        event.stopPropagation();
    });

    div_after_dot_iner.onclick = function () {
        post.remove();

        // إزالة المنشور من localStorage
        savedPosts = savedPosts.filter(p => p.id !== postId);
        localStorage.setItem('posts', JSON.stringify(savedPosts));
    };

    div_like.onclick = function () {
        let postIndex = savedPosts.findIndex(p => p.id === postId);
        if (postIndex !== -1) {
            if (likes[postId] === false || likes[postId] === undefined) {
                likes[postId] = true;
                like_result.style.display = 'block';
                like_result.style.color = 'green';
                div_like.style.color = '#00ff4c';
            } else {
                likes[postId] = false;
                like_result.style.display = 'none';
                div_like.style.color = 'white';
            }
            localStorage.setItem('likes', JSON.stringify(likes));
        }
    };
    window.location.reload();


}
window.onload = function () {
    // إعداد التهيئة
    wel.style.height = '50px';
    setTimeout(function () {
        wel.style.height = '0px';
    }, 2000);

    // تحميل المنشورات والإعجابات من localStorage
    let savedPosts = JSON.parse(localStorage.getItem('posts')) || [];
    let likes = JSON.parse(localStorage.getItem('likes')) || {};
    let comments = JSON.parse(localStorage.getItem('comments')) || {};

    savedPosts.forEach(postData => {
        let post = document.createElement('div');
        post.classList.add('post');

        let img = document.createElement('img');
        img.style.position = 'relative';
        img.style.zIndex = '0';
        img.style.opacity = '.98';
        img.style.cursor = 'pointer';

        let postContent = document.createElement('div');
        postContent.innerHTML = `<p>${postData.text}</p>`;
        if (postData.imgSrc) {
            img.src = postData.imgSrc;
            img.style.width = '100%';
            img.style.maxHeight = '600px';
            img.style.borderRadius = '10px';
            postContent.appendChild(img);
        }

        let paner_post = document.createElement('div');
        paner_post.classList.add('paner-post');
        let three_dot = document.createElement('button');
        three_dot.classList.add('fas', 'fa-ellipsis-h', 'three-dot');

        let paner_post_img_div = document.createElement('div');
        paner_post_img_div.onclick=function(){
            head_img.click();
        }
        paner_post_img_div.classList.add('paner_post_img_div');
        let paner_post_img = document.createElement('img');
        paner_post_img.style.width = '40px';
        let pro = profile();
        paner_post_img.src = pro;
        paner_post_img_div.appendChild(paner_post_img);

        let div_after_dot = document.createElement('div');
        div_after_dot.classList.add('div_after_dot');
        let div_after_dot_iner = document.createElement('div');
        div_after_dot_iner.textContent = 'حذف المنشور';
        div_after_dot_iner.classList.add('div_after_dot_iner');
        div_after_dot.appendChild(div_after_dot_iner);

        let paner_post_img_name = document.createElement('p');
        paner_post_img_name.onclick=function(){
            head_img.click();
        }
        paner_post_img_name.classList.add('paner_post_img_name');
        paner_post_img_name.textContent = username();

        paner_post.appendChild(paner_post_img_div);
        paner_post.appendChild(paner_post_img_name);
        paner_post.appendChild(three_dot);

        let bottom_post = document.createElement('div');
        bottom_post.classList.add('bottom_post');
        let div_like = document.createElement('div');
        div_like.classList.add('div_like', 'fa', 'fa-thumbs-up');
        let div_comment = document.createElement('div');
        div_comment.classList.add('div_comment', 'fas', 'fa-comment');
        div_comment.style.color = 'white';
        bottom_post.appendChild(div_like);
        bottom_post.appendChild(div_comment);

        let like_result = document.createElement('p');
        like_result.classList.add('like_result');
        like_result.textContent = 'لقد قمت بالتفاعل برمز الاعجاب على هذا المنشور';

        // استخدام معرف المنشور (أو الفهرس) لتحديد حالة "أعجبني" في localStorage
        if (likes[postData.id] === false || likes[postData.id] === undefined) {
            like_result.style.display = 'none';
            div_like.style.color = 'white';
        } else {
            like_result.style.display = 'block';
            like_result.style.color = 'green';
            div_like.style.color = '#00ff4c';
        }

        let comment_result = document.createElement('div');
        comment_result.classList.add('comment_result');
        let img_comment = document.createElement('img');
        img_comment.classList.add('img_comment');
        img_comment.src = img.src;

        // تطبيق الشروط لتعديل عرض وطول الصورة
        img_comment.onload = function () {
            if (img_comment.width > 800) {
                img_comment.classList.add('hight_300');
                // img_comment.style.objectFit = 'cover';
            } else if (img_comment.height > 400) {
                img_comment.classList.add('width_300');
                // img_comment.style.objectFit = 'cover';
            } else {
                img_comment.classList.add('width_500');
                // img_comment.style.height = 'auto';
            }
        };

        let inp_comment = document.createElement('input');
        inp_comment.placeholder = "اكتب تعليقا";
        inp_comment.classList.add('inp_comment');

        let inp_btn_comment = document.createElement('button');
        inp_btn_comment.classList.add('fas', 'fa-chevron-circle-right', 'inp_btn_comment');

        let x = document.createElement('button');
        x.textContent = 'x';
        x.classList.add('x');

        let br = document.createElement('br');

        let cont_comment = document.createElement('div');
        cont_comment.style.width = "70%";
        cont_comment.style.borderRadius = '15px';
        cont_comment.style.color = 'white';
        cont_comment.style.marginLeft = '9%';
        cont_comment.style.marginBottom = '90px';

        inp_btn_comment.onclick = function () {
            if (inp_comment.value !== '') {
                let comment = inp_comment.value;

                let paner_cont_comment = document.createElement('div');

                let img_paner_comment = document.createElement('img');
                let pro = profile();
                img_paner_comment.src = pro;
                img_paner_comment.style.width = '30px';

                let img_paner_comment_div = document.createElement('div');
                img_paner_comment_div.style.width = '30px';
                img_paner_comment_div.style.height = '30px';
                img_paner_comment_div.style.overflow = 'hidden';
                img_paner_comment_div.style.borderRadius = '50%';
                img_paner_comment_div.appendChild(img_paner_comment);

                let name_paner_comment = document.createElement('p');
                name_paner_comment.textContent = username();
                name_paner_comment.style.color = '#00ffea';

                paner_cont_comment.appendChild(img_paner_comment_div);
                paner_cont_comment.appendChild(name_paner_comment);
                paner_cont_comment.style.display = 'flex';
                paner_cont_comment.style.alignItems = 'center';
                paner_cont_comment.style.gap = '5px';
                paner_cont_comment.style.width = '100%';

                let tex_comment = document.createElement('p');
                tex_comment.style.display = 'flex';
                tex_comment.style.flexWrap = 'wrap';
                tex_comment.style.justifyContent = 'flex-start';
                tex_comment.style.padding = '10px';
                tex_comment.style.width = 'fit-content';
                tex_comment.style.background = '#00537a';
                tex_comment.style.borderRadius = '10px';
                tex_comment.style.marginTop = '-8px';
                tex_comment.textContent = comment;

                cont_comment.appendChild(paner_cont_comment);
                cont_comment.appendChild(br);
                cont_comment.appendChild(tex_comment);

                comment_result.scrollTop = comment_result.scrollHeight;

                inp_comment.value = '';

                // حفظ التعليقات في localStorage
                if (!comments[postData.id]) {
                    comments[postData.id] = [];
                }
                comments[postData.id].push(comment);
                localStorage.setItem('comments', JSON.stringify(comments));
            }
        }

        let tl_comment = document.createElement('h2');
        tl_comment.textContent = 'التعليقات';
        tl_comment.style.color = 'white';

        comment_result.appendChild(img_comment);
        comment_result.appendChild(br);
        comment_result.appendChild(tl_comment);
        comment_result.appendChild(inp_comment);
        comment_result.appendChild(inp_btn_comment);
        comment_result.appendChild(x);
        comment_result.appendChild(br);
        comment_result.appendChild(cont_comment);

        // تحميل التعليقات المحفوظة من localStorage
        if (comments[postData.id]) {
            comments[postData.id].forEach(comment => {
                let paner_cont_comment = document.createElement('div');

                let img_paner_comment = document.createElement('img');
                let pro = profile();
                img_paner_comment.src = pro;
                img_paner_comment.style.width = '30px';

                let img_paner_comment_div = document.createElement('div');
                img_paner_comment_div.style.width = '30px';
                img_paner_comment_div.style.height = '30px';
                img_paner_comment_div.style.overflow = 'hidden';
                img_paner_comment_div.style.borderRadius = '50%';
                img_paner_comment_div.appendChild(img_paner_comment);

                let name_paner_comment = document.createElement('p');
                name_paner_comment.textContent = username();
                name_paner_comment.style.color = '#00ffea';

                paner_cont_comment.appendChild(img_paner_comment_div);
                paner_cont_comment.appendChild(name_paner_comment);
                paner_cont_comment.style.display = 'flex';
                paner_cont_comment.style.alignItems = 'center';
                paner_cont_comment.style.gap = '5px';
                paner_cont_comment.style.width = '100%';

                let tex_comment = document.createElement('p');
                tex_comment.style.display = 'flex';
                tex_comment.style.flexWrap = 'wrap';
                tex_comment.style.justifyContent = 'flex-start';
                tex_comment.style.padding = '10px';
                tex_comment.style.width = 'fit-content';
                tex_comment.style.background = '#00537a';
                tex_comment.style.borderRadius = '10px';
                tex_comment.style.marginTop = '-8px';
                tex_comment.textContent = comment;

                cont_comment.appendChild(paner_cont_comment);
                cont_comment.appendChild(br);
                cont_comment.appendChild(tex_comment);
            });
        }

        post.appendChild(div_after_dot);
        post.appendChild(paner_post);
        post.appendChild(postContent);
        post.appendChild(like_result);
        post.appendChild(bottom_post);
        contpost.appendChild(post);
        contpost.appendChild(comment_result);

        x.onclick = function () {
            comment_result.style.display = 'none';
        }

        img.onclick = function () {
            div_comment.click();
        }

        div_comment.onclick = function () {
            comment_result.style.display = 'flex';
        }

        div_like.onclick = function () {
            if (likes[postData.id] === false || likes[postData.id] === undefined) {
                likes[postData.id] = true;
                like_result.style.display = 'block';
                like_result.style.color = 'green';
                div_like.style.color = '#00ff4c';
            } else {
                likes[postData.id] = false;
                like_result.style.display = 'none';
                div_like.style.color = 'white';
            }
            localStorage.setItem('likes', JSON.stringify(likes));
        };

        document.addEventListener('click', function (event) {
            if (!div_after_dot_iner.contains(event.target)) {
                div_after_dot_iner.style.transform = 'translate(0px, -50px)';
                div_after_dot.style.transform = 'translate(0px, 0px)';
                not.classList.remove('hight_50');
                not.classList.add('no_hight');
            }
            div_after_dot.style.zIndex = '0';
        });

        three_dot.addEventListener('click', function (event) {
            div_after_dot_iner.style.transform = 'translate(-10px, 50px)';
            div_after_dot.style.display = "block";
            div_after_dot_iner.onclick = function () {
                post.remove();

                // إزالة المنشور من localStorage
                savedPosts = savedPosts.filter(p => p.id !== postData.id);
                localStorage.setItem('posts', JSON.stringify(savedPosts));
            };
            event.stopPropagation();
            div_after_dot.style.zIndex = '2';
        });
    });

    // إعداد الوضع الداكن أو الفاتح بناءً على localStorage
    if (localStorage.pool) {
        let m = JSON.parse(localStorage.pool);
        if (m === true) {
            btn.classList.add('trn');
            main.classList.add('mod');
            document.body.style.color = 'white';
            tl.style.color = 'white';
            sidbar.classList.remove('light');
            sidbar.classList.add('dark');
            sid.forEach(button => button.classList.add('sid-dark'));
            paner.style.background = '#032c4d';
        } else {
            document.body.style.color = 'black';
            tl.style.color = '#08324d';
            sidbar.classList.add('light');
            sid.forEach(button => button.classList.add('sid-light'));
            paner.style.background = 'white';
        }
    } else {
        document.body.style.color = 'black';
        tl.style.color = 'black';
        sidbar.classList.add('light');
        sid.forEach(button => button.classList.add('sid-light'));
    }
};
window.addEventListener('storage', function (event) {
    if (event.key === 'posts' || event.key === 'likes' || event.key === 'comments') {
        loadPostsAndSettings();  // إعادة تحميل المنشورات والإعجابات والتعليقات
    } else if (event.key === 'pool') {
        applyDarkMode(JSON.parse(event.newValue));  // تحديث الوضع الداكن/الفاتح
    }
});
cont.addEventListener('click', () => {
    if (!btn.classList.contains('trn')) {
        btn.classList.add('trn');
        main.classList.add('mod');
        document.body.style.color = 'white';
        tl.style.color = 'white';
        sidbar.classList.remove('light');
        sidbar.classList.add('dark');
        sid.forEach(button => {
            button.classList.remove('sid-light');
            button.classList.add('sid-dark');
        });
        paner.style.background = '#032c4d';
        localStorage.setItem('pool', true);
    } else {
        btn.classList.remove('trn');
        main.classList.remove('mod');
        document.body.style.color = 'black';
        tl.style.color = '#08324d';
        sidbar.classList.remove('dark');
        sidbar.classList.add('light');
        sid.forEach(button => {
            button.classList.remove('sid-dark');
            button.classList.add('sid-light');
        });
        paner.style.background = 'white';
        localStorage.setItem('pool', false);
    }
});

sid[0].addEventListener('click', () => {
    if (sidbar.classList.contains('open')) {
        sidbar.classList.remove('open');
        box.classList.remove('iso');
        box.style.opacity = '0';
    } else {
        sidbar.classList.add('open');
        box.classList.add('iso');
        box.style.opacity = '1';
    }
});

box.addEventListener('click', () => {
    if (sidbar.classList.contains('open')) {
        sidbar.classList.remove('open');
        box.classList.remove('iso');
        box.style.opacity = '0';
    }
});
let scroll_up = document.querySelector('.scroll_up');
let lastScrollTop = 0; // Variable to keep track of the last scroll position

window.addEventListener('scroll', function () {
    let currentScrollTop = window.scrollY;

    if (currentScrollTop >= 500) {
        scroll_up.style.display = 'block';
        if (currentScrollTop < lastScrollTop) {
            // Scrolling up
            scroll_up.style.display = 'none';
        }
    } else {
        scroll_up.style.display = 'none';
    }

    // Update the last scroll position
    lastScrollTop = currentScrollTop;
});

scroll_up.onclick = function () {
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function profile() {
    // استرجاع URL الصورة من localStorage أو من مصدر آخر
    const storedImage = localStorage.getItem('storedImage');
    return storedImage || 'mu f.jpg'; // عودة صورة افتراضية إذا لم تكن هناك صورة محفوظة
}
function username() {
    let f = localStorage.getItem('first_name');
    let l = localStorage.getItem('last_name');
    let u = f + ' ' + l;
    return u;
}
function f_name(){
    let f = localStorage.getItem('first_name');
    return f;
}

if (localStorage.getItem('profileImageUrl')) {
    let pro = profile();
    let img1 = document.querySelector('.img1');
    img1.src = pro;
}
else {
    let pro = profile();
    let img1 = document.querySelector('.img1');
    img1.src = pro;
}
let user1=document.querySelector('.user1');
user1.textContent=f_name()+" ";
let head_img=document.querySelector('.profile_img');
head_img.onclick=function(){
    window.location.href='../profile/index.html';
}
let pp=document.querySelector('.pp');
pp.onclick=function(){

    head_img.click();
}
    </script>
</body>

</html>